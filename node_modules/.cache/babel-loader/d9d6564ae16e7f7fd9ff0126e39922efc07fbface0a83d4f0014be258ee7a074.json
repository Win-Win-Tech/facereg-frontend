{"ast":null,"code":"import React,{useRef,useState,useEffect}from'react';import Webcam from'react-webcam';import axios from'axios';import'./WebcamCapture.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const WebcamCapture=()=>{const webcamRef=useRef(null);const[message,setMessage]=useState('');const[screenSaver,setScreenSaver]=useState(false);const[isProcessing,setIsProcessing]=useState(false);useEffect(()=>{const interval=setInterval(()=>{if(!isProcessing&&!screenSaver){captureAndSend();}},2000);// every 2 seconds\nreturn()=>clearInterval(interval);},[isProcessing,screenSaver]);const captureAndSend=async()=>{const imageSrc=webcamRef.current.getScreenshot();if(!imageSrc)return;setIsProcessing(true);const blob=await(await fetch(imageSrc)).blob();const formData=new FormData();formData.append('image',blob,'face.jpg');try{const response=await axios.post('/attendance/',formData,{headers:{'Content-Type':'multipart/form-data'}});setMessage(\"\\u2705 Attendance marked for \".concat(response.data.employee,\" (Confidence: \").concat(response.data.confidence,\")\"));setScreenSaver(true);setTimeout(()=>{setScreenSaver(false);setMessage('');},5000);// screen saver duration\n}catch(error){// Optional: handle errors silently or show message\nsetMessage('');}finally{setIsProcessing(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"camera-wrapper\",children:[/*#__PURE__*/_jsx(Webcam,{audio:false,ref:webcamRef,screenshotFormat:\"image/jpeg\",className:\"camera-feed\",videoConstraints:{facingMode:'user'}}),screenSaver&&/*#__PURE__*/_jsx(\"div\",{className:\"screen-saver\",children:\"Attendance Marked\"}),message&&/*#__PURE__*/_jsx(\"div\",{className:\"message\",children:message})]});};export default WebcamCapture;// import React, { useRef, useState } from 'react';\n// import Webcam from 'react-webcam';\n// import axios from 'axios';\n// const WebcamCapture = () => {\n//   const webcamRef = useRef(null);\n//   const [name, setName] = useState('');\n//   const [mode, setMode] = useState('attendance'); // 'register' or 'attendance'\n//   const [message, setMessage] = useState('');\n//   const captureAndSend = async () => {\n//     const imageSrc = webcamRef.current.getScreenshot();\n//     if (!imageSrc) {\n//       setMessage('‚ùå Unable to capture image. Please try again.');\n//       return;\n//     }\n//     const blob = await (await fetch(imageSrc)).blob();\n//     const formData = new FormData();\n//     formData.append('image', blob, 'face.jpg');\n//     if (mode === 'register') formData.append('name', name);\n//     try {\n//       const endpoint = mode === 'register' ? '/register/' : '/attendance/';\n//       const response = await axios.post(endpoint, formData, {\n//         headers: { 'Content-Type': 'multipart/form-data' },\n//       });\n//       if (mode === 'register') {\n//         setMessage(`‚úÖ Registered: ${response.data.name} (ID: ${response.data.employee_id})`);\n//       } else {\n//         setMessage(`‚úÖ Attendance marked for ${response.data.employee} (Confidence: ${response.data.confidence})`);\n//       }\n//     } catch (error) {\n//       const errMsg = error.response?.data?.error || 'Server error. Try again.';\n//       setMessage(`‚ùå ${errMsg}`);\n//     }\n//   };\n//   return (\n//     <div style={{ textAlign: 'center' }}>\n//       <h2>{mode === 'register' ? 'Face Registration' : 'Mark Attendance'}</h2>\n//       <Webcam\n//         audio={false}\n//         ref={webcamRef}\n//         screenshotFormat=\"image/jpeg\"\n//         width={320}\n//         height={240}\n//         videoConstraints={{ facingMode: 'user' }}\n//       />\n//       {mode === 'register' && (\n//         <input\n//           type=\"text\"\n//           placeholder=\"Enter name\"\n//           value={name}\n//           onChange={(e) => setName(e.target.value)}\n//           style={{ marginTop: '10px', padding: '5px' }}\n//         />\n//       )}\n//       <div style={{ marginTop: '10px' }}>\n//         <button onClick={captureAndSend}>üì∑ Capture & Submit</button>\n//         <button onClick={() => setMode(mode === 'register' ? 'attendance' : 'register')} style={{ marginLeft: '10px' }}>\n//           üîÑ Switch to {mode === 'register' ? 'Attendance' : 'Register'}\n//         </button>\n//       </div>\n//       <p style={{ marginTop: '20px', fontWeight: 'bold' }}>{message}</p>\n//     </div>\n//   );\n// };\n// export default WebcamCapture;","map":{"version":3,"names":["React","useRef","useState","useEffect","Webcam","axios","jsx","_jsx","jsxs","_jsxs","WebcamCapture","webcamRef","message","setMessage","screenSaver","setScreenSaver","isProcessing","setIsProcessing","interval","setInterval","captureAndSend","clearInterval","imageSrc","current","getScreenshot","blob","fetch","formData","FormData","append","response","post","headers","concat","data","employee","confidence","setTimeout","error","className","children","audio","ref","screenshotFormat","videoConstraints","facingMode"],"sources":["E:/ravi/frontend/src/WebcamCapture.js"],"sourcesContent":["import React, { useRef, useState, useEffect } from 'react';\r\nimport Webcam from 'react-webcam';\r\nimport axios from 'axios';\r\nimport './WebcamCapture.css';\r\n\r\nconst WebcamCapture = () => {\r\n  const webcamRef = useRef(null);\r\n  const [message, setMessage] = useState('');\r\n  const [screenSaver, setScreenSaver] = useState(false);\r\n  const [isProcessing, setIsProcessing] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      if (!isProcessing && !screenSaver) {\r\n        captureAndSend();\r\n      }\r\n    }, 2000); // every 2 seconds\r\n\r\n    return () => clearInterval(interval);\r\n  }, [isProcessing, screenSaver]);\r\n\r\n  const captureAndSend = async () => {\r\n    const imageSrc = webcamRef.current.getScreenshot();\r\n    if (!imageSrc) return;\r\n\r\n    setIsProcessing(true);\r\n    const blob = await (await fetch(imageSrc)).blob();\r\n    const formData = new FormData();\r\n    formData.append('image', blob, 'face.jpg');\r\n\r\n    try {\r\n      const response = await axios.post('/attendance/', formData, {\r\n        headers: { 'Content-Type': 'multipart/form-data' },\r\n      });\r\n\r\n      setMessage(`‚úÖ Attendance marked for ${response.data.employee} (Confidence: ${response.data.confidence})`);\r\n      setScreenSaver(true);\r\n\r\n      setTimeout(() => {\r\n        setScreenSaver(false);\r\n        setMessage('');\r\n      }, 5000); // screen saver duration\r\n    } catch (error) {\r\n      // Optional: handle errors silently or show message\r\n      setMessage('');\r\n    } finally {\r\n      setIsProcessing(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"camera-wrapper\">\r\n      <Webcam\r\n        audio={false}\r\n        ref={webcamRef}\r\n        screenshotFormat=\"image/jpeg\"\r\n        className=\"camera-feed\"\r\n        videoConstraints={{ facingMode: 'user' }}\r\n      />\r\n      {screenSaver && <div className=\"screen-saver\">Attendance Marked</div>}\r\n      {message && <div className=\"message\">{message}</div>}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default WebcamCapture;\r\n\r\n\r\n\r\n\r\n\r\n\r\n// import React, { useRef, useState } from 'react';\r\n// import Webcam from 'react-webcam';\r\n// import axios from 'axios';\r\n\r\n// const WebcamCapture = () => {\r\n//   const webcamRef = useRef(null);\r\n//   const [name, setName] = useState('');\r\n//   const [mode, setMode] = useState('attendance'); // 'register' or 'attendance'\r\n//   const [message, setMessage] = useState('');\r\n\r\n//   const captureAndSend = async () => {\r\n//     const imageSrc = webcamRef.current.getScreenshot();\r\n//     if (!imageSrc) {\r\n//       setMessage('‚ùå Unable to capture image. Please try again.');\r\n//       return;\r\n//     }\r\n\r\n//     const blob = await (await fetch(imageSrc)).blob();\r\n//     const formData = new FormData();\r\n//     formData.append('image', blob, 'face.jpg');\r\n//     if (mode === 'register') formData.append('name', name);\r\n\r\n//     try {\r\n//       const endpoint = mode === 'register' ? '/register/' : '/attendance/';\r\n//       const response = await axios.post(endpoint, formData, {\r\n//         headers: { 'Content-Type': 'multipart/form-data' },\r\n//       });\r\n\r\n//       if (mode === 'register') {\r\n//         setMessage(`‚úÖ Registered: ${response.data.name} (ID: ${response.data.employee_id})`);\r\n//       } else {\r\n//         setMessage(`‚úÖ Attendance marked for ${response.data.employee} (Confidence: ${response.data.confidence})`);\r\n//       }\r\n//     } catch (error) {\r\n//       const errMsg = error.response?.data?.error || 'Server error. Try again.';\r\n//       setMessage(`‚ùå ${errMsg}`);\r\n//     }\r\n//   };\r\n\r\n//   return (\r\n//     <div style={{ textAlign: 'center' }}>\r\n//       <h2>{mode === 'register' ? 'Face Registration' : 'Mark Attendance'}</h2>\r\n//       <Webcam\r\n//         audio={false}\r\n//         ref={webcamRef}\r\n//         screenshotFormat=\"image/jpeg\"\r\n//         width={320}\r\n//         height={240}\r\n//         videoConstraints={{ facingMode: 'user' }}\r\n//       />\r\n//       {mode === 'register' && (\r\n//         <input\r\n//           type=\"text\"\r\n//           placeholder=\"Enter name\"\r\n//           value={name}\r\n//           onChange={(e) => setName(e.target.value)}\r\n//           style={{ marginTop: '10px', padding: '5px' }}\r\n//         />\r\n//       )}\r\n//       <div style={{ marginTop: '10px' }}>\r\n//         <button onClick={captureAndSend}>üì∑ Capture & Submit</button>\r\n//         <button onClick={() => setMode(mode === 'register' ? 'attendance' : 'register')} style={{ marginLeft: '10px' }}>\r\n//           üîÑ Switch to {mode === 'register' ? 'Attendance' : 'Register'}\r\n//         </button>\r\n//       </div>\r\n//       <p style={{ marginTop: '20px', fontWeight: 'bold' }}>{message}</p>\r\n//     </div>\r\n//   );\r\n// };\r\n\r\n// export default WebcamCapture;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}